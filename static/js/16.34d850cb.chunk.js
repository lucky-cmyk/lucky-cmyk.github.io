(this.webpackJsonpstardust_web=this.webpackJsonpstardust_web||[]).push([[16],{1184:function(e,t,n){"use strict";n(4),n(7),n(88)},1317:function(e,t,n){"use strict";n.r(t);n(380);var a=n(381),r=(n(354),n(355)),c=(n(132),n(57)),s=n(4),u=n.n(s),i=n(31),o=n(7),l=n(70),d=n(0),b=n(35),f=n(102),p=(n(134),n(357),n(358)),j=(n(1177),n(1180)),O=(n(151),n(71)),m=(n(208),n(72)),h=(n(207),n(133)),v=(n(360),n(359)),x=n(372),k=n(579),g=n(10),y=v.a.Option,w=h.a.TextArea,S=function(e){var t=e.onCancel,n=e.visible,a=e.onOk,r=e.perms,c=e.users,s=m.a.useForm(),b=Object(l.a)(s,1)[0],f=Object(d.useState)([]),x=Object(l.a)(f,2),S=x[0],C=x[1],_=function(){var e=Object(o.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:try{b.validateFields().then(Object(o.a)(u.a.mark((function e(){var t;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(k.d)(Object(i.a)(Object(i.a)({},b.getFieldsValue()),{},{permissions_ids:S.toString(),user_ids:null===(t=b.getFieldValue("user_ids"))||void 0===t?void 0:t.toString()}));case 2:b.resetFields(),K([]),O.b.success("\u521b\u5efa\u6210\u529f"),a();case 6:case"end":return e.stop()}}),e)}))))}catch(t){console.error(t)}case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),E=Object(d.useState)([""]),F=Object(l.a)(E,2),I=F[0],z=F[1],N=Object(d.useState)([""]),P=Object(l.a)(N,2),V=P[0],K=P[1],T=Object(d.useState)([]),q=Object(l.a)(T,2),D=q[0],R=q[1],A=Object(d.useState)(!0),B=Object(l.a)(A,2),J=B[0],L=B[1];return Object(g.jsx)(p.a,{title:"\u521b\u5efa\u89d2\u8272",visible:n,onCancel:function(){b.resetFields(),K([]),t()},onOk:_,children:Object(g.jsxs)(m.a,Object(i.a)(Object(i.a)({},{labelCol:{span:6},wrapperCol:{span:18}}),{},{form:b,name:"form_in_modal",hideRequiredMark:!0,children:[Object(g.jsx)(m.a.Item,{label:"\u89d2\u8272\u540d",name:"name",rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u89d2\u8272\u540d"}],children:Object(g.jsx)(h.a,{placeholder:"\u8bf7\u8f93\u5165\u89d2\u8272\u540d"})}),Object(g.jsx)(m.a.Item,{label:"\u5907\u6ce8",name:"remarks",rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u5907\u6ce8"}],children:Object(g.jsx)(w,{placeholder:"\u8bf7\u8f93\u5165\u5907\u6ce8"})}),Object(g.jsx)(m.a.Item,{label:"\u6743\u9650",name:"permissions_ids",children:Object(g.jsx)(j.a,{checkable:!0,onExpand:function(e){z(e),L(!1)},expandedKeys:I,autoExpandParent:J,onCheck:function(e,t){C(e.concat(t.halfCheckedKeys)),K(e)},checkedKeys:V,onSelect:function(e,t){R(e)},selectedKeys:D,treeData:r})}),Object(g.jsx)(m.a.Item,{label:"\u6240\u5c5e\u7528\u6237",name:"user_ids",children:Object(g.jsx)(v.a,{style:{width:"100%"},placeholder:"\u8bf7\u9009\u62e9\u7528\u6237",mode:"multiple",children:c.map((function(e){return Object(g.jsx)(y,{value:e.id,children:e.uname},e.id)}))})})]}))})},C=Object(d.memo)(S),_=n(90),E=v.a.Option,F=h.a.TextArea,I=function(e){var t=e.onCancel,n=e.visible,a=e.onOk,r=e.perms,c=e.users,s=e.name,b=e.id,f=e.remarks,x=m.a.useForm(),y=Object(l.a)(x,1)[0],w=Object(d.useState)([]),S=Object(l.a)(w,2),C=S[0],I=S[1],z=Object(d.useState)([]),N=Object(l.a)(z,2),P=(N[0],N[1]),V=function(){var e=Object(o.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:try{y.validateFields().then(Object(o.a)(u.a.mark((function e(){var t;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(k.g)(Object(i.a)(Object(i.a)({},y.getFieldsValue()),{},{permissions_ids:C.toString(),user_ids:null===(t=y.getFieldValue("user_ids"))||void 0===t?void 0:t.toString(),id:b}));case 2:y.resetFields(),J([]),O.b.success("\u4fee\u6539\u6210\u529f"),a();case 6:case"end":return e.stop()}}),e)}))))}catch(t){console.error(t)}case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),K=Object(d.useState)([""]),T=Object(l.a)(K,2),q=T[0],D=T[1],R=Object(d.useState)([""]),A=Object(l.a)(R,2),B=A[0],J=A[1],L=Object(d.useState)([]),M=Object(l.a)(L,2),H=M[0],Y=M[1],G=Object(d.useState)(!0),Q=Object(l.a)(G,2),U=Q[0],W=Q[1],X=function(){var e=Object(o.a)(u.a.mark((function e(){var t,n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(k.a)({role_id:b});case 2:t=e.sent,n=t.data,P(n),y.setFieldsValue({user_ids:n});case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Z=function(){var e=Object(o.a)(u.a.mark((function e(){var t,n,a;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(k.c)({role_id:b});case 2:t=e.sent,n=Object(_.h)(t.data,{key:"id",title:"name",children:"child",check:"check",checkState:!0}),J(n),a=Object(_.g)(t.data,{key:"id",title:"name",children:"child",check:"check",checkState:!0}),I(a);case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(d.useEffect)((function(){n&&(y.setFieldsValue({name:s,remarks:f}),X(),Z())}),[n]),Object(g.jsx)(p.a,{title:"\u4fee\u6539\u89d2\u8272",visible:n,onCancel:function(){y.resetFields(),t()},onOk:V,children:Object(g.jsxs)(m.a,Object(i.a)(Object(i.a)({},{labelCol:{span:6},wrapperCol:{span:18}}),{},{form:y,name:"form_in_modal",hideRequiredMark:!0,children:[Object(g.jsx)(m.a.Item,{label:"\u89d2\u8272\u540d",name:"name",rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u89d2\u8272\u540d"}],children:Object(g.jsx)(h.a,{placeholder:"\u8bf7\u8f93\u5165\u89d2\u8272\u540d"})}),Object(g.jsx)(m.a.Item,{label:"\u5907\u6ce8",name:"remarks",rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u5907\u6ce8"}],children:Object(g.jsx)(F,{placeholder:"\u8bf7\u8f93\u5165\u5907\u6ce8"})}),Object(g.jsx)(m.a.Item,{label:"\u6743\u9650",name:"permissions_ids",children:Object(g.jsx)(j.a,{checkable:!0,onExpand:function(e){D(e),W(!1)},expandedKeys:q,autoExpandParent:U,onCheck:function(e,t){I(e.concat(t.halfCheckedKeys)),J(e)},checkedKeys:B,onSelect:function(e,t){Y(e)},selectedKeys:H,treeData:r})}),Object(g.jsx)(m.a.Item,{label:"\u6240\u5c5e\u7528\u6237",name:"user_ids",children:Object(g.jsx)(v.a,{style:{width:"100%"},placeholder:"\u8bf7\u9009\u62e9\u7528\u6237",mode:"multiple",children:c.map((function(e){return Object(g.jsx)(E,{value:e.id,children:e.uname},e.id)}))})})]}))})},z=Object(d.memo)(I),N=(n(378),n(377)),P=(n(388),n(390)),V=(n(443),n(1184),function(e,t){var n=e.handleEdit,a=Object(d.useState)(!1),c=Object(l.a)(a,2),s=c[0],b=c[1],f=Object(d.useState)([]),p=Object(l.a)(f,2),j=p[0],m=p[1],h=(e.modifypassword_h,e.modifyaccountRole_h,e.block_h,e.pageSize),v=void 0===h?5:h,y=e.total,w=void 0===y?20:y,S=(e.showTotal,Object(d.useState)({current:1,pageSize:v||0,total:w||0})),C=Object(l.a)(S,2),E=C[0],F=C[1],I=function(){var e=Object(o.a)(u.a.mark((function e(t){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Object(k.e)({id:t});case 3:O.b.success("\u5220\u9664\u6210\u529f"),(E.total-1)/E.pageSize<E.current&&1!=E.current?F(Object(i.a)(Object(i.a)({},E),{},{current:E.current-1})):V(),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.error(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}(),z=[{title:"\u89d2\u8272\u540d\u79f0",dataIndex:"name",key:"id"},{title:"\u89d2\u8272\u8bf4\u660e",dataIndex:"remarks"},{title:"\u521b\u5efa\u65f6\u95f4",dataIndex:"created_at"},{title:"\u521b\u5efa\u4eba",dataIndex:"create_user_name"},{title:"\u64cd\u4f5c",dataIndex:"disabled",render:function(e,t){return Object(g.jsxs)(r.b,{size:"middle",children:[Object(g.jsx)("a",{onClick:function(){return n(t.name,t.id,t.remarks)},children:"\u7f16\u8f91"}),Object(g.jsx)(P.a,{title:"\u786e\u5b9a\u5220\u9664\u8fd9\u6761\u6570\u636e?",onConfirm:function(){return I(t.id)},okText:"Yes",cancelText:"No",children:Object(g.jsx)("a",{children:"\u5220\u9664"})})]})}}];Object(d.useImperativeHandle)(t,(function(){return{getData:function(e){V(e)}}}));var V=function(){var e=Object(o.a)(u.a.mark((function e(){var t,n,a,r,c,s=arguments;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=s.length>0&&void 0!==s[0]?s[0]:{},e.prev=1,b(!0),e.next=5,Object(k.f)(Object(i.a)({page:E.current,page_size:E.pageSize},t));case 5:if(!((n=e.sent).data.length>0)){e.next=13;break}return a=Object(_.b)(n.data,{key:"create_user"}),e.next=10,Object(x.d)({user_ids:a.toString()});case 10:r=e.sent,c=r.data,n.data=Object(_.d)(n.data,{key:"create_user",data:c,trans_key:"create_user_name"});case 13:m(n.data),b(!1),F(Object(i.a)(Object(i.a)({},E),{},{total:n.page.count,pageSize:n.page.page_size})),e.next=22;break;case 18:e.prev=18,e.t0=e.catch(1),b(!1),console.error(e.t0);case 22:case"end":return e.stop()}}),e,null,[[1,18]])})));return function(){return e.apply(this,arguments)}}();Object(d.useEffect)(Object(o.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:V();case 1:case"end":return e.stop()}}),e)}))),[E.current]);return Object(g.jsx)(g.Fragment,{children:Object(g.jsx)(N.a,{rowKey:"id",bordered:!0,loading:s,columns:z,dataSource:j,pagination:E,onChange:function(e){F(Object(i.a)({},e))}})})}),K=Object(d.forwardRef)(V);t.default=function(e){var t=Object(d.useState)([]),n=Object(l.a)(t,2),s=(n[0],n[1],Object(d.useState)(!1)),i=Object(l.a)(s,2),p=(i[0],i[1],Object(d.useState)(!1)),j=Object(l.a)(p,2),O=(j[0],j[1],Object(d.useState)([])),m=Object(l.a)(O,2),h=(m[0],m[1],Object(d.useState)()),v=Object(l.a)(h,2),y=(v[0],v[1],Object(d.useState)(!1)),w=Object(l.a)(y,2),S=w[0],_=w[1],E=Object(d.useState)(!1),F=Object(l.a)(E,2),I=F[0],N=F[1],P=Object(d.useState)(""),V=Object(l.a)(P,2),T=V[0],q=V[1],D=Object(d.useState)(""),R=Object(l.a)(D,2),A=R[0],B=R[1],J=Object(d.useState)(""),L=Object(l.a)(J,2),M=L[0],H=L[1],Y=Object(d.useState)(""),G=Object(l.a)(Y,2),Q=G[0],U=G[1],W=Object(d.useState)([]),X=Object(l.a)(W,2),Z=X[0],$=X[1],ee=Object(d.useRef)(),te=Object(b.c)((function(e){return e.appids}));Object(d.useEffect)((function(){}),[te]);var ne=function e(t,n){var a=[],r=n.key,c=n.title,s=n.children;return t.map((function(t){a.push({key:t[r],title:t[c],children:t[s]?e(t[s],n):[]})})),a},ae=function(){var e=Object(o.a)(u.a.mark((function e(){var t,n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Object(k.b)();case 3:t=e.sent,n=ne(t.data,{key:"id",title:"name",children:"child"}),U(n),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),console.error(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(){return e.apply(this,arguments)}}(),re=function(){var e=Object(o.a)(u.a.mark((function e(){var t;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(x.a)({page:1,page_size:1e4});case 2:t=e.sent,$(t.data);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(d.useEffect)((function(){ae(),re()}),[]),Object(g.jsxs)(f.a,{title:e.route.title,children:[Object(g.jsx)(r.b,{children:Object(g.jsx)(c.a,{type:"primary",onClick:function(){_(!0)},children:"\u521b\u5efa\u89d2\u8272"})}),Object(g.jsx)(a.a,{dashed:!0}),Object(g.jsx)(K,{ref:ee,handleEdit:function(e,t,n){!function(e,t,n){B(e),q(t),H(n)}(e,t,n),N(!0)}}),Object(g.jsx)(C,{onOk:function(){ee.current.getData(),_(!1)},visible:S,onCancel:function(){_(!1)},perms:Q,users:Z}),Object(g.jsx)(z,{perms:Q,users:Z,id:T,name:A,remarks:M,visible:I,onOk:function(){ee.current.getData(),N(!1)},onCancel:function(){N(!1)}})]})}},372:function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return o})),n.d(t,"e",(function(){return l})),n.d(t,"g",(function(){return d})),n.d(t,"f",(function(){return b})),n.d(t,"d",(function(){return f})),n.d(t,"c",(function(){return p}));var a=n(4),r=n.n(a),c=n(7),s=n(88),u=n(8),i=function(){var e=Object(c.a)(r.a.mark((function e(t){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s.a.post("/admin/user-web/create",t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),o=function(){var e=Object(c.a)(r.a.mark((function e(t){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",s.a.get("/admin/user-web/gets",t));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),l=function(){var e=Object(c.a)(r.a.mark((function e(t){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s.a.put("/admin/user-web/update-password",t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),d=function(){var e=Object(c.a)(r.a.mark((function e(t){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",s.a.put("/admin/user-web/update-block",t));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),b=function(){var e=Object(c.a)(r.a.mark((function e(t){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",s.a.put("/admin/user-web/update-role",t));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),f=function(){var e=Object(c.a)(r.a.mark((function e(t){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",s.a.get("/admin/component/gets-by-user-name",t));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),p=function(){var e=Object(c.a)(r.a.mark((function e(t,n){var a;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,u.a.get("/users/".concat(t,"/accountLog"),{params:n});case 2:return a=e.sent,e.abrupt("return",null===a||void 0===a?void 0:a.data);case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},388:function(e,t,n){"use strict";n(49),n(389),n(132),n(402)},389:function(e,t,n){"use strict";n(49),n(394)},390:function(e,t,n){"use strict";var a=n(1),r=n(5),c=n(0),s=n(6),u=n.n(s),i=n(43),o=n(105),l=n(29),d=n(104),b=n(57),f=n(153),p=n(73),j=n(54),O=n(51),m=n(391),h=n(21),v=n(62),x=n(447),k=void 0,g=function(e,t){var n={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(n[a]=e[a]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var r=0;for(a=Object.getOwnPropertySymbols(e);r<a.length;r++)t.indexOf(a[r])<0&&Object.prototype.propertyIsEnumerable.call(e,a[r])&&(n[a[r]]=e[a[r]])}return n},y=c.forwardRef((function(e,t){var n=c.useContext(O.b).getPrefixCls,s=Object(i.a)(!1,{value:e.visible,defaultValue:e.defaultVisible}),o=Object(r.a)(s,2),y=o[0],w=o[1],S=function(t,n){var a;w(t),null===(a=e.onVisibleChange)||void 0===a||a.call(e,t,n)},C=function(e){S(!1,e)},_=function(t){var n;return null===(n=e.onConfirm)||void 0===n?void 0:n.call(k,t)},E=function(t){var n;S(!1,t),null===(n=e.onCancel)||void 0===n||n.call(k,t)},F=e.prefixCls,I=e.placement,z=e.children,N=e.overlayClassName,P=g(e,["prefixCls","placement","children","overlayClassName"]),V=n("popover",F),K=n("popconfirm",F),T=u()(K,N),q=c.createElement(p.a,{componentName:"Popconfirm",defaultLocale:j.a.Popconfirm},(function(t){return function(t,r){var s=e.okButtonProps,u=e.cancelButtonProps,i=e.title,o=e.cancelText,l=e.okText,d=e.okType,p=e.icon;return c.createElement("div",{className:"".concat(t,"-inner-content")},c.createElement("div",{className:"".concat(t,"-message")},p,c.createElement("div",{className:"".concat(t,"-message-title")},Object(m.a)(i))),c.createElement("div",{className:"".concat(t,"-buttons")},c.createElement(b.a,Object(a.a)({onClick:E,size:"small"},u),o||r.cancelText),c.createElement(x.a,{buttonProps:Object(a.a)(Object(a.a)({size:"small"},Object(f.a)(d)),s),actionFn:_,close:C,prefixCls:n("btn"),quitOnNullishReturnValue:!0,emitEvent:!0},l||r.okText)))}(V,t)})),D=n();return c.createElement(d.a,Object(a.a)({},P,{prefixCls:V,placement:I,onVisibleChange:function(t){e.disabled||S(t)},visible:y,overlay:q,overlayClassName:T,ref:t,transitionName:Object(v.b)(D,"zoom-big",e.transitionName)}),Object(h.a)(z,{onKeyDown:function(e){var t,n;c.isValidElement(z)&&(null===(n=null===z||void 0===z?void 0:(t=z.props).onKeyDown)||void 0===n||n.call(t,e)),function(e){e.keyCode===l.a.ESC&&y&&S(!1,e)}(e)}}))}));y.defaultProps={placement:"top",trigger:"click",okType:"primary",icon:c.createElement(o.a,null),disabled:!1},t.a=y},391:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var a=function(e){return e?"function"===typeof e?e():e:null}},394:function(e,t,n){},402:function(e,t,n){},443:function(e,t,n){"use strict";n(4),n(7),n(8)},579:function(e,t,n){"use strict";n.d(t,"f",(function(){return r})),n.d(t,"e",(function(){return c})),n.d(t,"d",(function(){return s})),n.d(t,"g",(function(){return u})),n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return o})),n.d(t,"a",(function(){return l}));var a=n(88),r=function(e){return a.a.get("/admin/role/gets",e)},c=function(e){return a.a.delete("/admin/role/delete",e)},s=function(e){return a.a.jpost("/admin/role/create",e)},u=function(e){return a.a.put("/admin/role/update",e)},i=function(e){return a.a.get("/admin/permissions/gets",e)},o=function(e){return a.a.get("/admin/role/get-permissions",e)},l=function(e){return a.a.get("/admin/role/get-role-by-user",e)}}}]);
//# sourceMappingURL=16.34d850cb.chunk.js.map