(this.webpackJsonpstardust_web=this.webpackJsonpstardust_web||[]).push([[17],{1198:function(e,t,n){"use strict";n(2),n(7),n(89)},1323:function(e,t,n){"use strict";n.r(t);n(395);var r=n(396),a=(n(369),n(370)),c=(n(133),n(58)),u=n(2),s=n.n(u),i=n(31),o=n(7),l=n(72),d=n(0),b=n(36),f=n(103),p=(n(135),n(372),n(374)),j=(n(1191),n(1194)),O=(n(152),n(63)),m=(n(211),n(73)),h=(n(210),n(134)),v=(n(376),n(375)),x=n(397),k=n(602),y=n(10),g=v.a.Option,w=h.a.TextArea,S=function(e){var t=e.onCancel,n=e.visible,r=e.onOk,a=e.perms,c=e.users,u=m.a.useForm(),b=Object(l.a)(u,1)[0],f=Object(d.useState)([]),x=Object(l.a)(f,2),S=x[0],C=x[1],_=function(){var e=Object(o.a)(s.a.mark((function e(){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:try{b.validateFields().then(Object(o.a)(s.a.mark((function e(){var t;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(k.d)(Object(i.a)(Object(i.a)({},b.getFieldsValue()),{},{permissions_ids:S.toString(),user_ids:null===(t=b.getFieldValue("user_ids"))||void 0===t?void 0:t.toString()}));case 2:b.resetFields(),N([]),O.b.success("\u521b\u5efa\u6210\u529f"),r();case 6:case"end":return e.stop()}}),e)}))))}catch(t){console.error(t)}case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),E=Object(d.useState)([""]),F=Object(l.a)(E,2),I=F[0],z=F[1],P=Object(d.useState)([""]),V=Object(l.a)(P,2),K=V[0],N=V[1],T=Object(d.useState)([]),q=Object(l.a)(T,2),D=q[0],R=q[1],A=Object(d.useState)(!0),B=Object(l.a)(A,2),J=B[0],L=B[1];return Object(y.jsx)(p.a,{title:"\u521b\u5efa\u89d2\u8272",visible:n,onCancel:function(){b.resetFields(),N([]),t()},onOk:_,children:Object(y.jsxs)(m.a,Object(i.a)(Object(i.a)({},{labelCol:{span:6},wrapperCol:{span:18}}),{},{form:b,name:"form_in_modal",hideRequiredMark:!0,children:[Object(y.jsx)(m.a.Item,{label:"\u89d2\u8272\u540d",name:"name",rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u89d2\u8272\u540d"}],children:Object(y.jsx)(h.a,{placeholder:"\u8bf7\u8f93\u5165\u89d2\u8272\u540d"})}),Object(y.jsx)(m.a.Item,{label:"\u5907\u6ce8",name:"remarks",rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u5907\u6ce8"}],children:Object(y.jsx)(w,{placeholder:"\u8bf7\u8f93\u5165\u5907\u6ce8"})}),Object(y.jsx)(m.a.Item,{label:"\u6743\u9650",name:"permissions_ids",children:Object(y.jsx)(j.a,{checkable:!0,onExpand:function(e){z(e),L(!1)},expandedKeys:I,autoExpandParent:J,onCheck:function(e,t){C(e.concat(t.halfCheckedKeys)),N(e)},checkedKeys:K,onSelect:function(e,t){R(e)},selectedKeys:D,treeData:a})}),Object(y.jsx)(m.a.Item,{label:"\u6240\u5c5e\u7528\u6237",name:"user_ids",children:Object(y.jsx)(v.a,{style:{width:"100%"},placeholder:"\u8bf7\u9009\u62e9\u7528\u6237",mode:"multiple",children:c.map((function(e){return Object(y.jsx)(g,{value:e.id,children:e.uname},e.id)}))})})]}))})},C=Object(d.memo)(S),_=n(90),E=v.a.Option,F=h.a.TextArea,I=function(e){var t=e.onCancel,n=e.visible,r=e.onOk,a=e.perms,c=e.users,u=e.name,b=e.id,f=e.remarks,x=m.a.useForm(),g=Object(l.a)(x,1)[0],w=Object(d.useState)([]),S=Object(l.a)(w,2),C=S[0],I=S[1],z=Object(d.useState)([]),P=Object(l.a)(z,2),V=(P[0],P[1]),K=function(){var e=Object(o.a)(s.a.mark((function e(){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:try{g.validateFields().then(Object(o.a)(s.a.mark((function e(){var t;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(k.g)(Object(i.a)(Object(i.a)({},g.getFieldsValue()),{},{permissions_ids:C.toString(),user_ids:null===(t=g.getFieldValue("user_ids"))||void 0===t?void 0:t.toString(),id:b}));case 2:O.b.success("\u4fee\u6539\u6210\u529f"),r();case 4:case"end":return e.stop()}}),e)}))))}catch(t){console.error(t)}case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),N=Object(d.useState)([""]),T=Object(l.a)(N,2),q=T[0],D=T[1],R=Object(d.useState)([""]),A=Object(l.a)(R,2),B=A[0],J=A[1],L=Object(d.useState)([]),M=Object(l.a)(L,2),H=M[0],G=M[1],Q=Object(d.useState)(!0),U=Object(l.a)(Q,2),W=U[0],X=U[1],Y=function(){var e=Object(o.a)(s.a.mark((function e(){var t,n;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(k.a)({role_id:b});case 2:t=e.sent,n=t.data,V(n),g.setFieldsValue({user_ids:n});case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Z=function(){var e=Object(o.a)(s.a.mark((function e(){var t,n,r;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(k.c)({role_id:b});case 2:t=e.sent,n=Object(_.i)(t.data,{key:"id",title:"name",children:"child",check:"check",checkState:!0}),J(n),r=Object(_.h)(t.data,{key:"id",title:"name",children:"child",check:"check",checkState:!0}),I(r);case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(d.useEffect)((function(){n&&(g.setFieldsValue({name:u,remarks:f}),Y(),Z())}),[n]),Object(y.jsx)(p.a,{title:"\u4fee\u6539\u89d2\u8272",visible:n,onCancel:function(){t()},onOk:K,afterClose:function(){return g.resetFields(),void J([])},children:Object(y.jsxs)(m.a,Object(i.a)(Object(i.a)({},{labelCol:{span:6},wrapperCol:{span:18}}),{},{form:g,name:"form_in_modal",hideRequiredMark:!0,children:[Object(y.jsx)(m.a.Item,{label:"\u89d2\u8272\u540d",name:"name",rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u89d2\u8272\u540d"}],children:Object(y.jsx)(h.a,{placeholder:"\u8bf7\u8f93\u5165\u89d2\u8272\u540d"})}),Object(y.jsx)(m.a.Item,{label:"\u5907\u6ce8",name:"remarks",rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u5907\u6ce8"}],children:Object(y.jsx)(F,{placeholder:"\u8bf7\u8f93\u5165\u5907\u6ce8"})}),Object(y.jsx)(m.a.Item,{label:"\u6743\u9650",name:"permissions_ids",children:Object(y.jsx)(j.a,{checkable:!0,onExpand:function(e){D(e),X(!1)},expandedKeys:q,autoExpandParent:W,onCheck:function(e,t){I(e.concat(t.halfCheckedKeys)),J(e)},checkedKeys:B,onSelect:function(e,t){G(e)},selectedKeys:H,treeData:a})}),Object(y.jsx)(m.a.Item,{label:"\u6240\u5c5e\u7528\u6237",name:"user_ids",children:Object(y.jsx)(v.a,{style:{width:"100%"},placeholder:"\u8bf7\u9009\u62e9\u7528\u6237",mode:"multiple",children:c.map((function(e){return Object(y.jsx)(E,{value:e.id,children:e.uname},e.id)}))})})]}))})},z=Object(d.memo)(I),P=(n(394),n(393)),V=(n(405),n(407)),K=(n(539),n(1198),function(e,t){var n=e.handleEdit,r=Object(d.useState)(!1),c=Object(l.a)(r,2),u=c[0],b=c[1],f=Object(d.useState)([]),p=Object(l.a)(f,2),j=p[0],m=p[1],h=(e.modifypassword_h,e.modifyaccountRole_h,e.block_h,e.pageSize),v=void 0===h?5:h,g=e.total,w=void 0===g?20:g,S=(e.showTotal,Object(d.useState)({current:1,pageSize:v||0,total:w||0})),C=Object(l.a)(S,2),E=C[0],F=C[1],I=function(){var e=Object(o.a)(s.a.mark((function e(t){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Object(k.e)({id:t});case 3:O.b.success("\u5220\u9664\u6210\u529f"),(E.total-1)/E.pageSize<E.current&&1!=E.current?F(Object(i.a)(Object(i.a)({},E),{},{current:E.current-1})):K(),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.error(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}(),z=[{title:"\u89d2\u8272\u540d\u79f0",dataIndex:"name",key:"id"},{title:"\u89d2\u8272\u8bf4\u660e",dataIndex:"remarks"},{title:"\u521b\u5efa\u65f6\u95f4",dataIndex:"created_at"},{title:"\u521b\u5efa\u4eba",dataIndex:"create_user_name"},{title:"\u64cd\u4f5c",dataIndex:"disabled",render:function(e,t){return Object(y.jsxs)(a.b,{size:"middle",children:[Object(y.jsx)("a",{onClick:function(){return n(t.name,t.id,t.remarks)},children:"\u7f16\u8f91"}),Object(y.jsx)(V.a,{title:"\u786e\u5b9a\u5220\u9664\u8fd9\u6761\u6570\u636e?",onConfirm:function(){return I(t.id)},okText:"\u786e\u8ba4",cancelText:"\u53d6\u6d88",children:Object(y.jsx)("a",{children:"\u5220\u9664"})})]})}}];Object(d.useImperativeHandle)(t,(function(){return{getData:function(e){K(e)}}}));var K=function(){var e=Object(o.a)(s.a.mark((function e(){var t,n,r,a,c,u=arguments;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=u.length>0&&void 0!==u[0]?u[0]:{},e.prev=1,b(!0),e.next=5,Object(k.f)(Object(i.a)({page:E.current,page_size:E.pageSize},t));case 5:if(!((n=e.sent).data.length>0)){e.next=13;break}return r=Object(_.c)(n.data,{key:"create_user"}),e.next=10,Object(x.d)({user_ids:r.toString()});case 10:a=e.sent,c=a.data,n.data=Object(_.e)(n.data,{key:"create_user",data:c,trans_key:"create_user_name"});case 13:m(n.data),b(!1),F(Object(i.a)(Object(i.a)({},E),{},{total:n.page.count,pageSize:n.page.page_size})),e.next=22;break;case 18:e.prev=18,e.t0=e.catch(1),b(!1),console.error(e.t0);case 22:case"end":return e.stop()}}),e,null,[[1,18]])})));return function(){return e.apply(this,arguments)}}();Object(d.useEffect)(Object(o.a)(s.a.mark((function e(){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:K();case 1:case"end":return e.stop()}}),e)}))),[E.current]);return Object(y.jsx)(y.Fragment,{children:Object(y.jsx)(P.a,{rowKey:"id",bordered:!0,loading:u,columns:z,dataSource:j,pagination:E,onChange:function(e){F(Object(i.a)({},e))}})})}),N=Object(d.forwardRef)(K);t.default=function(e){var t=Object(d.useState)([]),n=Object(l.a)(t,2),u=(n[0],n[1],Object(d.useState)(!1)),i=Object(l.a)(u,2),p=(i[0],i[1],Object(d.useState)(!1)),j=Object(l.a)(p,2),O=(j[0],j[1],Object(d.useState)([])),m=Object(l.a)(O,2),h=(m[0],m[1],Object(d.useState)()),v=Object(l.a)(h,2),g=(v[0],v[1],Object(d.useState)(!1)),w=Object(l.a)(g,2),S=w[0],_=w[1],E=Object(d.useState)(!1),F=Object(l.a)(E,2),I=F[0],P=F[1],V=Object(d.useState)(""),K=Object(l.a)(V,2),T=K[0],q=K[1],D=Object(d.useState)(""),R=Object(l.a)(D,2),A=R[0],B=R[1],J=Object(d.useState)(""),L=Object(l.a)(J,2),M=L[0],H=L[1],G=Object(d.useState)(""),Q=Object(l.a)(G,2),U=Q[0],W=Q[1],X=Object(d.useState)([]),Y=Object(l.a)(X,2),Z=Y[0],$=Y[1],ee=Object(d.useRef)(),te=Object(b.c)((function(e){return e.appids}));Object(d.useEffect)((function(){}),[te]);var ne=function e(t,n){var r=[],a=n.key,c=n.title,u=n.children;return t.map((function(t){r.push({key:t[a],title:t[c],children:t[u]?e(t[u],n):[]})})),r},re=function(){var e=Object(o.a)(s.a.mark((function e(){var t,n;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Object(k.b)();case 3:t=e.sent,n=ne(t.data,{key:"id",title:"name",children:"child"}),W(n),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),console.error(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(){return e.apply(this,arguments)}}(),ae=function(){var e=Object(o.a)(s.a.mark((function e(){var t;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(x.a)({page:1,page_size:1e4});case 2:t=e.sent,$(t.data);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(d.useEffect)((function(){re(),ae()}),[]),Object(y.jsxs)(f.a,{title:e.route.title,children:[Object(y.jsx)(a.b,{children:Object(y.jsx)(c.a,{type:"primary",onClick:function(){_(!0)},children:"\u521b\u5efa\u89d2\u8272"})}),Object(y.jsx)(r.a,{dashed:!0}),Object(y.jsx)(N,{ref:ee,handleEdit:function(e,t,n){!function(e,t,n){B(e),q(t),H(n)}(e,t,n),P(!0)}}),Object(y.jsx)(C,{onOk:function(){ee.current.getData(),_(!1)},visible:S,onCancel:function(){_(!1)},perms:U,users:Z}),Object(y.jsx)(z,{perms:U,users:Z,id:T,name:A,remarks:M,visible:I,onOk:function(){ee.current.getData(),P(!1)},onCancel:function(){P(!1)}})]})}},397:function(e,t,n){"use strict";n.d(t,"c",(function(){return i})),n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return l})),n.d(t,"e",(function(){return d})),n.d(t,"g",(function(){return b})),n.d(t,"f",(function(){return f})),n.d(t,"d",(function(){return p}));var r=n(2),a=n.n(r),c=n(7),u=n(89),s=n(8),i=function(){var e=Object(c.a)(a.a.mark((function e(t,n){var r;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s.a.get("/users/".concat(t,"/accountLog"),{params:n});case 2:return r=e.sent,e.abrupt("return",null===r||void 0===r?void 0:r.data);case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),o=function(){var e=Object(c.a)(a.a.mark((function e(t){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,u.a.post("/user-web/create",t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),l=function(){var e=Object(c.a)(a.a.mark((function e(t){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",u.a.get("/user-web/gets",t));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),d=function(){var e=Object(c.a)(a.a.mark((function e(t){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,u.a.put("/user-web/update-password",t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),b=function(){var e=Object(c.a)(a.a.mark((function e(t){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",u.a.put("/user-web/update-block",t));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),f=function(){var e=Object(c.a)(a.a.mark((function e(t){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",u.a.put("/user-web/update-role",t));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),p=function(){var e=Object(c.a)(a.a.mark((function e(t){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",u.a.get("/component/gets-by-user-name",t));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},405:function(e,t,n){"use strict";n(41),n(406),n(133),n(424)},406:function(e,t,n){"use strict";n(41),n(409)},407:function(e,t,n){"use strict";var r=n(1),a=n(5),c=n(0),u=n(6),s=n.n(u),i=n(44),o=n(106),l=n(29),d=n(105),b=n(58),f=n(154),p=n(74),j=n(55),O=n(48),m=n(408),h=n(17),v=n(64),x=n(491),k=void 0,y=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var a=0;for(r=Object.getOwnPropertySymbols(e);a<r.length;a++)t.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(e,r[a])&&(n[r[a]]=e[r[a]])}return n},g=c.forwardRef((function(e,t){var n=c.useContext(O.b).getPrefixCls,u=Object(i.a)(!1,{value:e.visible,defaultValue:e.defaultVisible}),o=Object(a.a)(u,2),g=o[0],w=o[1],S=function(t,n){var r;w(t),null===(r=e.onVisibleChange)||void 0===r||r.call(e,t,n)},C=function(e){S(!1,e)},_=function(t){var n;return null===(n=e.onConfirm)||void 0===n?void 0:n.call(k,t)},E=function(t){var n;S(!1,t),null===(n=e.onCancel)||void 0===n||n.call(k,t)},F=e.prefixCls,I=e.placement,z=e.children,P=e.overlayClassName,V=y(e,["prefixCls","placement","children","overlayClassName"]),K=n("popover",F),N=n("popconfirm",F),T=s()(N,P),q=c.createElement(p.a,{componentName:"Popconfirm",defaultLocale:j.a.Popconfirm},(function(t){return function(t,a){var u=e.okButtonProps,s=e.cancelButtonProps,i=e.title,o=e.cancelText,l=e.okText,d=e.okType,p=e.icon;return c.createElement("div",{className:"".concat(t,"-inner-content")},c.createElement("div",{className:"".concat(t,"-message")},p,c.createElement("div",{className:"".concat(t,"-message-title")},Object(m.a)(i))),c.createElement("div",{className:"".concat(t,"-buttons")},c.createElement(b.a,Object(r.a)({onClick:E,size:"small"},s),o||a.cancelText),c.createElement(x.a,{buttonProps:Object(r.a)(Object(r.a)({size:"small"},Object(f.a)(d)),u),actionFn:_,close:C,prefixCls:n("btn"),quitOnNullishReturnValue:!0,emitEvent:!0},l||a.okText)))}(K,t)})),D=n();return c.createElement(d.a,Object(r.a)({},V,{prefixCls:K,placement:I,onVisibleChange:function(t){e.disabled||S(t)},visible:g,overlay:q,overlayClassName:T,ref:t,transitionName:Object(v.b)(D,"zoom-big",e.transitionName)}),Object(h.a)(z,{onKeyDown:function(e){var t,n;c.isValidElement(z)&&(null===(n=null===z||void 0===z?void 0:(t=z.props).onKeyDown)||void 0===n||n.call(t,e)),function(e){e.keyCode===l.a.ESC&&g&&S(!1,e)}(e)}}))}));g.defaultProps={placement:"top",trigger:"click",okType:"primary",icon:c.createElement(o.a,null),disabled:!1},t.a=g},408:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r=function(e){return e?"function"===typeof e?e():e:null}},409:function(e,t,n){},424:function(e,t,n){},539:function(e,t,n){"use strict";n(2),n(7),n(8)},602:function(e,t,n){"use strict";n.d(t,"f",(function(){return a})),n.d(t,"e",(function(){return c})),n.d(t,"d",(function(){return u})),n.d(t,"g",(function(){return s})),n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return o})),n.d(t,"a",(function(){return l}));var r=n(89),a=function(e){return r.a.get("/role/gets",e)},c=function(e){return r.a.delete("/role/delete",e)},u=function(e){return r.a.jpost("/role/create",e)},s=function(e){return r.a.put("/role/update",e)},i=function(e){return r.a.get("/permissions/gets",e)},o=function(e){return r.a.get("/role/get-permissions",e)},l=function(e){return r.a.get("/role/get-role-by-user",e)}}}]);